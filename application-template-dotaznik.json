{
	"apiVersion": "v1",
	"kind": "Template",
	"metadata": {
		"description": "pojďme se najest",
		"name": "dotaznik"
	},
	"items": [
		{
			"apiVersion": "v1",
			"kind": "BuildConfig",
			"metadata": {
				"annotations": {
				"description": "Definice sestavení",
				"template.alpha.openshift.io/wait-for-ready": "true"
				},
				"name": "${NAME}"
				},
			"spec": {
				"output": {
				"to": {
					"kind": "ImageStreamTag",
					"name": "${NAME}:latest"
				}
				},
				"source": {
					"contextDir": "${CONTEXT_DIR}",
					"git": {
					"ref": "${SOURCE_REPOSITORY_REF}",
					"uri": "${SOURCE_REPOSITORY_URL}"
				},
				"type": "Git"
				},
				"strategy": {
					"type": "Docker"
				},
				"triggers": [
					{
						"type": "ConfigChange"
					},
					{
						"type": "ImageChange"
					}
				]
			}
		},
		{
			"apiVersion": "v1",
			"kind": "ImageStream",
			"metadata": {
				"annotations": {
				"description": "sleduje změny v aplikačním obraze"
				},
				"name": "${NAME}"
			}
		},
		{
			"apiVersion": "v1",
			"kind": "DeploymentConfig",
			"metadata": {
				"annotations": {
					"description": "Nasazení webové aplikace"
				},
				"name": "${NAME}"
			},
			"spec": {
				"replicas": 1,
				"selector": {
					"name": "${NAME}"
				},
				"strategy": {
					"type": "Recreate"
				}
			},
				"template": {
					"metadata": {
						"labels": {
							"name": "${DATABASE_SERVICE_NAME}"
						}
					},
						"name": "${NAME}"
				},
					"spec": {
						"containers": [
							{
								"imagePullPolicy": "Always",
								"name": "${NAME}",
								"ports": [
									{
										"containerPort": 8080,
										"protocol": "TCP"
									}
								]
							}
						]
					},
			"triggers": [
				{
					"type": "ConfigChange"
				},
				{
					"from": {
					"kind": "ImageStreamTag",
					"name": "${NAME}:latest"
					},
					"type": "ImageChange"
				}
			]
		},
		{
			"apiVersion": "v1",
			"kind": "Route",
			"metadata": {
				"name": "${NAME}"
			},
			"spec": {
				"host": "${APPLICATION_DOMAIN}",
				"to": {
					"kind": "Service",
					"name": "${NAME}"
				}
			}
		},
		{
			"apiVersion": "v1",
			"kind": "Service",
			"metadata": {
				"annotations": {
					"description": "vystavenení aplikace a její vyvažování"
					},
					"name": "${NAME}"
				},
			"spec": {
				"ports": [
					{
						"name": "${NAME}",
						"port": 8080,
						"protocol": "TCP",
						"targetPort": 8080
					}
				],
				"selector": {
					"name": "${NAME}"
				}
			}
		}
		],
    "parameters": [
        {
            "description": "Název všech frontendových objektů definovaných v template",
            "displayName": "Name",
            "name": "NAME",
            "required": true,
            "value": ""
        },
        {
            "description": "Git URL se zdrojovými kódy.",
            "displayName": "Git Repository URL",
            "name": "SOURCE_REPOSITORY_URL",
            "required": true,
            "value": ""
        },
        {
            "description": "The exposed hostname that will route to the CakePHP service, if left blank a value will be defaulted.",
            "displayName": "Application Hostname",
            "name": "APPLICATION_DOMAIN",
            "value": ""
        },
        {
            "description": "Set this to the relative path to your project if it is not in the root of your repository.",
            "displayName": "Context Directory",
            "name": "CONTEXT_DIR"
        }
    ]
}
